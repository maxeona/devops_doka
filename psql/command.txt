select * from pg_stat_activity; - статистика по всем базам
\a - переключ режима выравнивания
\t - заголовки вывода 
\x - расширенный формат
\o /tmp/{name_file} - записать в указанное место результат запроса !!!!!!! (после команды с новой строки ввод запроса, и оно запи)
\password {user} - change password !!!!!!!!
create user "{name_user}" with encrypted password '{passwd}'; 

create database mydb; 
ALTER DATABASE {name} RENAME TO {name}; - переименование базы
ALTER DATABASE {name} CONNECTION LIMIT {number}; - изменение кол-во подключений
ALTER DATABASE {name} SET search_path = public, name; or enother sequence



Вход в субд под другим пользаком: psql -U {name}

ALTER TABLE {name} SET SCHEMA {name_schema}; -перемещение объекта между схемами
*т.к схемы, это логическая организация, перемещение происходит только в системном каталоге, сами данные физически остаются на месте
функция current_schemas - показывает реальное знач пути поиска
select current_schemas(true);

SELECT pg_reload_conf(); - reload pg_hba
Список всех юзеров psql: select * from pg_shadow;

https://postgrespro.ru/media/docs/postgresql/11/ru/postgres-A4.pdf

https://kamaok.org.ua/?p=961

COPY {name} TO '/tmp/{name}.csv' WITH (FORMAT CSV, HEADER); - копирование таблицы в опред формат (перед этим надо сделать коннект к таблице)

psql {name_db} переключение базы данных 
ALTER DATABASE {name_db} OWNER TO {name_owner};
grant all privileges on database {db_name} to {name_owner}; 
ALTER USER otr RENAME TO "rw-otr"; пример переименовывания юзера в базе 
ALTER USER {name} WITH SUPERUSER{или другую роль};

\c {data_base} →а потом → (т.е необходимо выбрать базу данных, где будут проводиться действия)
GRANT  ALL ON ALL TABLES IN SCHEMA public TO {user}; -гранты на  все таблицы в схеме  

REVOKE ALL ON SCHEMA public FROM {user}; - отозвать права

ALTER USER "rw-otr” WITH PASSWORD 'f26F3Bz6'; пример смены пароля у пользователя в базе 

TRUNCATE – очистить таблицу, либо набор таблиц
Прим.* надо переключиться на таблицу, в которой необходимо провести очистку 
TRUNCATE {table_name,…..};

DELETE FROM {table_name} WHERE {condition}; - удаление строк по условию
pg_dumpall -Upostgres > /opt/data/{name}.sql - бэкап базы
или так, а то чет не сработало ласт раз
pg_dump -U grafana_db > /opt/backup/grafana_table_20210922.sql
-n -название схемы; -d название базы; -t - название таблицы
Добавление ключей: (-d{database_name}, -t{table_name})
psql -U{name} < /opt/{name}.sql  - разворачивание бэкапа 

psql -U{user} -h /{name_schema} {name_db} -e “QUERY”  - запрос в бд через терминал  


\dt -list table in data base 

######################################################
                Системные каталоги
######################################################
находятся в системной схеме pg_catalog;
pg_database - список и фактура по базам на в данном кластере 
select pg_size_pretty(pg_databse_size('{name_bd}')); - размер указанной базы

ALTER TABLE {name} SET SCHEMA {name_schema}; -перемещение объекта между схемами
*т.к схемы, это логическая организация, перемещение происходит только в системном каталоге, сами данные физически остаются на месте
функция current_schemas - показывает реальное знач пути поиска
select current_schemas(true);
